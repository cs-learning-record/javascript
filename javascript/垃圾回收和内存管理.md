![image](../img/timg.jpg)
<br>

## 前言

本人平时学习及收集内容，欢迎参入一起讨论。

## 关于作者

一个工作八年的草根程序员。

## 内容

- [垃圾回收机制](#一垃圾回收机制)
- [内存的生命周期](#二内存的生命周期)
- [标记清除](#三标记清除)
- [引用计数](#四引用计数)
- [IE6的性能问题](#五IE6的性能问题)
- [编码注意-解除引用](#六编码注意-解除引用)
- [垃圾回收的优化策略](#七垃圾回收的优化策略)
- [分代回收](#八分代回收)
- [增量回收](#九增量回收)
- [查看Chrome浏览器下的CG过程](#十查看Chrome浏览器下的CG过程)

JavaScript具有自动垃圾收集机制，也就是说，执行环境会负责管理代码执行过程中使用的内存。而在C和C++之类的语言中，开发人员的一项基本任务就是手工跟踪内在的使用情况，这是造成许多问题的一个根源。

在编写JavaScript程序时，开发人员不用再关心内存使用问题，所需内存的分配以及无用内存的回收完全实现了自动管理。这种垃圾收集机制的原理其实很简单：**找出那些不再继续使用的变量，然后释放其占用的内存。**为此，垃圾收集器会按照固定的时间间隔（或代码执行中预定的收集时间），周期性地执行这一操作。

正因为垃圾回收器的存在，许多人认为JavaScript不用太关心内存管理的问题。其实不然，如果不了解JavaScript的垃圾回收机制，写出来的代码会容易成内存泄漏（内存无法被回收）的情况。所以，

### 一、垃圾回收机制

#### 内存的分配场景

- [对象](#1.1-对象)
- [数组](#1.2-数组)
- [字符串](#1.3-字符串)
- [函数](#1.4-函数)
- [闭包](#1.5-闭包)

##### 1.1 对象

```
new Object();
new MyConstructor();
{a:4,b:5}
Object.create();

```

##### 1.2 数组

```
new Array();
[1,2,3,4];

```

##### 1.3 字符串

```
// 3.字符串，JavaScript 的字符串和 .NET 一样，使用资源池和 copy on write 方式管理字符串。
new String("hello hyddd"); 
"<p>" + e.innerHTML + "</p>" 

```

##### 1.4 函数

```
var x = function () { ... } 
new Function(code); 

```

##### 1.5 闭包

```
function outer(name) {
     var x = name; 
     return function inner() { 
        return "Hi, " + name; 
     } 
 }

```

### 二、内存的生命周期

函数中局部变量的正常生命周期。

- **内在分配：**局部变量只在函数执行的过程中存在。而在这个过程中，会为局部变量在栈（或堆）内存上分配相应的空间，以便存储它们的值。
- **内在使用：**然后在函数中使用这些变量，直到函数执行结束。
- **内存回收：**此时，局部变量就没有存在的必要了因此可以释放它们的内存以供将来使用。

通常，很容易判断变量是否还有存在的必要，但并非所有情况下都这么容易就能得出结论（）。

### 三、标记清除

JavaScript中最常用的垃圾收集方式是**标记清除**。当变量进入环境（例如，在函数中声明一个变量）时，就将这个变量为“进入环境”。从逻辑上讲，永远不能释放进入环境的变量所占用的内存，因为只要执行流进入相应的环境，就可能会乃至它们。而当变量离开环境时，则将其标记为“离开环境”。

```
function test(){
    var a = 10; //被标记，进入环境
    var b=20;   // 被标记，进入环境
}
test(); // 执行完毕之后a、b又被标离开环境，被回收。

```
垃圾回收器在运行的时候会给存储在内存中的

### 四、引用计数

### 五、IE6的性能问题

### 六、编码注意-解除引用

### 七、垃圾回收的优化策略

### 八、分代回收

### 九、增量回收

### 十、增量回收

### 参考资料

- [垃圾回收和内存管理](https://github.com/stone0090/javascript-lessons/tree/master/2.6-GC&MemoryManagement)
- [前端面试：谈谈 JS 垃圾回收机制](https://github.com/qq449245884/xiaozhi/issues/36)
- [JavaScript 是如何工作的：JavaScript 的内存模型](https://github.com/qq449245884/xiaozhi/issues/21)
- [JavaScript如何工作:内存管理+如何处理4个常见的内存泄漏](https://github.com/qq449245884/xiaozhi/issues/3)
- 《高程第3版》

## 联系作者

<div align="center">
    <p>
        在颠覆世界的同时，也要好好关照自己。
    </p>
    <img src="../img/contact.png" />
</div>