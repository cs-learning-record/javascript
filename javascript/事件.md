![image](../img/timg.jpg)
<br>

## 前言

本人平时学习及收集内容，欢迎参入一起讨论。

## 关于作者

一个工作八年的草根程序员。

## 内容

- [事件流](#一事件流)
- [事件处理](#二事件处理)
- [事件对象](#三事件对象)
- [事件类型](#四事件类型)
- [事件委托](#五事件委托)
- [模拟事件](#六模拟事件)

### 一、事件流

"DOM2级事件"规定的事件流包括三个阶段：事件捕获阶段、处于目标阶段、事件冒泡阶段。

![](./img/event.png)

**捕获阶段：**事件从Document节点自上而下向目标节点传播的阶段；
**目标阶段：**真正的目标节点正在处理事件的阶段；
**冒泡阶段：**事件从目标节点自上而下向Document节点传播的阶段;

### 二、事件处理

- HTML事件处理程序
- DOM0级事件处理程序
- DOM2级事件处理程序（不支持IE）
- IE事件处理程序
- 跨浏览器的事件处理程序

#### 2.1 HTML事件处理程序

它是写在html里面的，是全局作用域。

```
例子代码--点击事件触发alert函数
<button onclick="alert('hello')"></button>

```

#### 2.2 DOM0级事件处理程序

```
<button id="btn">点击</button>
 
<script>
  var btn=document.getElementById("btn");
  btn.onclick=function(){
    alert("hello");
  }
</script>

```

#### 2.3 DOM2级事件处理程序（不支持IE）

有了DOM2级事件处理程序，其中定义了两个方法：

- addEventListener() ---添加事件侦听器
- removeEventListener() ---删除事件侦听器

函数均有3个参数:

- 第一个参数是要处理的事件名(不带on前缀的才是事件名)
- 第二个参数是作为事件处理程序的函数
- 第三个参数是一个boolean值，默认false表示使用冒泡机制，true表示捕获机制。

```
<button id="btn">点击</button>
 
<script>
  var btn=document.getElementById("btn");
  btn.addEventListener('click',hello，false);
  btn.addEventListener('click',hello，false);
  function hello(){
    alert("hello");
  }
</script>

```

#### 2.4 IE事件处理程序

IE事件处理程序中有类似与DOM2级事件处理程序的两个方法：

1. attachEvent()
2. detachEvent()

它们都接收两个参数：

1. 事件处理程序名称。如onclick、onmouseover，注意：这里不是事件，而是事件处理程序的名称，所以有on。
2. 事件处理程序函数。

```
<button id="btn">点击</button>
 
<script>
  var btn=document.getElementById("btn");
  btn.attachEvent('onclick',hello);
  btn.detachEvent('onclick',hello);
  function hello(){
    alert("hello");
  }
</script>
```

#### 2.5 跨浏览器的事件处理程序

```

var EventUtil={
    addHandler:function(element,type,handler){
        if(element.addEventListener){
            element.addEventListener(type,handler,false);
        }else if(element.attachEvent){
            element.attachEvent('on'+type,handler);
        }else{
            element['on'+type]=handler;
        }
    },
    removeHandler:function(element,type,handler){
        if(element.removeEventListener){
            element.removeEventListener(type,handler,false);
        }else if(element.detachEvent){
            element.detachEvent('on'+type,handler);
        }else{
            element['on'+type]=null;
        }
    }
}

```

这两个方法接收相同的三个参数：

1. 要操作的元素--通过dom方法获取
2. 事件名称--注意：没有on，如"click"、"mouseover"
3. 事件处理程序函数--对应的函数

### 三、事件对象

#### 3.1 DOM中的事件对象

| 属性/方法                  | 类型    | 读/写 | 说明                                               |
| -------------------------- | ------- | ----- | -------------------------------------------------- |
| bubbles                    | Boolean | 只读  | 表明事件是否冒泡                                   |
| cancelable                 | Boolean | 只读  | 表明是否可以取消事件的默认行为                     |
| currentTarget              | Element | 只读  | 其事件处理程序当前正在处理事件的那个元素           |
| defaultPrevent             | Boolean | 只读  | 为true表示已经调用              了preventDefault() |
| detail                     | Integer | 只读  | 与事件相关的细节信息                               |
| eventPhase                 | Integer | 只读  | 调用事件处理程序的阶段：                           |
| preventDefault()           | Integer | 只读  |
| stopImmediatePropagation() | Integer | 只读  |
| stopPropagation()          | Integer | 只读  |
| target                     | Integer | 只读  |
| trusted                    | Integer | 只读  |
| type                       | Integer | 只读  |
| view                       | Integer | 只读  |

#### 3.2 IE中的事件对象

| 属性/方法  | 类型    | 读/写 | 说明                           |
| ---------- | ------- | ----- | ------------------------------ |
| bubbles    | Boolean | 只读  | 表明事件是否冒泡               |
| cancelable | Boolean | 只读  | 表明是否可以取消事件的默认行为 |

#### 3.3 跨浏览器的事件对象

```
var EventUtil={
    addHandler:function(element,type,handler){
        if(element.addEventListener){
            element.addEventListener(type,handler,false);
        }else if(element.attachEvent){
            element.attachEvent('on'+type,handler);
        }else{
            element['on'+type]=handler;
        }
    },
    removeHandler:function(element,type,handler){
        if(element.removeEventListener){
            element.removeEventListener(type,handler,false);
        }else if(element.detachEvent){
            element.detachEvent('on'+type,handler);
        }else{
            element['on'+type]=null;
        }
    },
    getEvent:function(event){
        return event?event:window.event;
    },
    getTarget:function(event){
        return event.target || event.srcElement;
    },
    preventDefault:function(event){
        if(event.preventDefault){
            event.preventDefault();
        }else{
            event.returnValue=false;
        }
    },
    stopPropagetion:function(event){
        if(event.stopPropegation){
            event.stopPropagation();
        }else{
            event.cancelBubble=true;
        }
    }
}

```

### 四、事件类型

#### 4.1 UI事件

#### 4.2 焦点事件

#### 4.3 鼠标与滚轮事件

#### 4.4 复合事件

#### 4.5 变动事件

#### 4.6 HTML5事件

#### 4.7 设备事件

#### 4.8 触摸与手势事件


### 事件委托

```
    <button id="btnAdd">添加</button>
    <ul id="ulList">
        <li>1</li>
        <li>2</li>
        <li>3</li>
    </ul>
    <script>
        var btnAdd = document.getElementById('btnAdd');
        var ulList = document.getElementById('ulList');
        var num = 3;

        ulList.onclick = function(event){
            var event = event || window.event;
            var target = event.target || event.srcElement;
            if(target.nodeName.toLowerCase() == 'li'){
                alert(target.innerHTML);
            }
        }

        btnAdd.onclick = function () {
            num++;
            var li = document.createElement('li');
            li.innerHTML = num;
            ulList.appendChild(li);
            doclick();
        }
    </script>

```

### 六、模拟事件


### 参考资料

- 《高程第3版》
- 《权威第6版》

## 联系作者

<div align="center">
    <p>
        在颠覆世界的同时，也要好好关照自己。
    </p>
    <img src="../img/contact.png" />
</div>